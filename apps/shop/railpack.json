{
  "$schema": "https://schema.railpack.com",
  "steps": {
    "install": {
      "commands": [
        "ROOT=$(cd . && while [ ! -f package-lock.json ] && [ \"$PWD\" != \"/\" ]; do cd ..; done && pwd)",
        "if [ ! -f \"$ROOT/package-lock.json\" ]; then echo 'Error: package-lock.json not found' && exit 1; fi",
        "cd \"$ROOT\" && npm ci"
      ]
    },
    "build": {
      "inputs": [{ "step": "install" }],
      "commands": [
        "ROOT=$(cd . && while [ ! -f package-lock.json ] && [ \"$PWD\" != \"/\" ]; do cd ..; done && pwd)",
        "cd \"$ROOT\" && npx nx build shop --configuration=production"
      ]
    }
  },
  "deploy": {
    "startCommand": "npx serve -s dist -l $PORT"
  }
}
